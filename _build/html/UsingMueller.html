

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using the Mueller module &mdash; pySCATMECH 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Using the Fresnel module" href="UsingFresnel.html" />
    <link rel="prev" title="pySCATMECH : A Python Interface to the SCATMECH Library" href="index.html" /> 

<link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
<script src="https://pages.nist.gov/nist-header-footer/js/jquery-1.9.0.min.js" type="text/javascript" defer="defer"></script>
<script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>

<script language="JavaScript" id="_fed_an_js_tag" src="/js/federated-analytics.all.min.js?agency=NIST&subagency=pml&pua=UA-37115410-46&yt=true"></script>


</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> pySCATMECH
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using the Mueller module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Mueller-matrices">Mueller matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Stokes-Vectors">Stokes Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Cloude-decomposition">Cloude decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Lu-Chipman-decomposition">Lu-Chipman decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Reverse-Lu-Chipman-decomposition">Reverse Lu-Chipman decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Symmetric-Decomposition">Symmetric Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Differential-(Logarithmic)-Decomposition">Differential (Logarithmic) Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Other-parameters">Other parameters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="UsingFresnel.html">Using the Fresnel module</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsingBRDF.html">Using the BRDF module</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsingLocal.html">Using the Local module</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsingIntegrate.html">Using the Integrate module</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsingScatterer.html">Using the Scatterer module</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsingRCW.html">Using the RCW module</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsingCrossRCW.html">Using the CrossRCW module</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mueller.html">Mueller Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="fresnel.html">Fresnel Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Model Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="brdf.html">BRDF Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="local.html">Local Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrate.html">Integrate Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="scatterer.html">Scatterer Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rcw.html">RCW Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="crossrcw.html">CrossRCW Module</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pySCATMECH</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Using the Mueller module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/UsingMueller.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Using-the-Mueller-module">
<h1>Using the Mueller module<a class="headerlink" href="#Using-the-Mueller-module" title="Permalink to this headline">¶</a></h1>
<p>In this notebook, we demonstrate how to use the Mueller module, which defines the <code class="docutils literal notranslate"><span class="pre">MuellerMatrix</span></code> and <code class="docutils literal notranslate"><span class="pre">StokesVector</span></code> classes and various operations on them.</p>
<p>The first thing, of course, is to import the package and some other packages that we will be using. We will be creating some random matrices and vectors, so we need <code class="docutils literal notranslate"><span class="pre">random</span></code>, and we will be graphing a few things, so we need <code class="docutils literal notranslate"><span class="pre">maptplotlib.pyplot</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pySCATMECH.mueller</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="section" id="Mueller-matrices">
<h2>Mueller matrices<a class="headerlink" href="#Mueller-matrices" title="Permalink to this headline">¶</a></h2>
<p>The class <code class="docutils literal notranslate"><span class="pre">MuellerMatrix</span></code> is used for handling Mueller matrices. Here we show several ways one can create a unit Mueller matrix. The <code class="docutils literal notranslate"><span class="pre">JonesMueller()</span></code> function converts a 2 x 2 complex Jones matrix into a Mueller matrix. And <code class="docutils literal notranslate"><span class="pre">MuellerUnit()</span></code> returns a unit Mueller matrix.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m1</span> <span class="o">=</span> <span class="n">MuellerMatrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">m2</span> <span class="o">=</span> <span class="n">MuellerMatrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">m3</span> <span class="o">=</span> <span class="n">MuellerMatrix</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">m4</span> <span class="o">=</span> <span class="n">JonesMueller</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">m5</span> <span class="o">=</span> <span class="n">MuellerUnit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[1. 0. 0. 0.]
 [0. 1. 0. 0.]
 [0. 0. 1. 0.]
 [0. 0. 0. 1.]]
</pre></div></div>
</div>
<p>We can check to see that these are valid matrices. The <code class="docutils literal notranslate"><span class="pre">valid</span></code> method tests whether a Mueller matrix maps the set of valid Stokes vectors onto itself. The <code class="docutils literal notranslate"><span class="pre">physically_valid</span></code> method tests whether a Mueller matrix is a convex sum of Jones-Mueller matrices. The latter is a more stringent test of whether the matrix is realizable.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">valid</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">physically_valid</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
True
</pre></div></div>
</div>
<p>But, a random matrix is not necessarily valid. In fact, it probably isn’t!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Returns a random number with a normal distribution...</span>
<span class="n">ran</span> <span class="o">=</span> <span class="k">lambda</span> <span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Create 20 random matrices...</span>
<span class="n">m1</span> <span class="o">=</span> <span class="p">[</span><span class="n">MuellerMatrix</span><span class="p">([[</span><span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">()],</span>
                    <span class="p">[</span><span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">()],</span>
                    <span class="p">[</span><span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">()],</span>
                    <span class="p">[</span><span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">()]])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>

<span class="c1"># See if they are valid...</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number value() is True:&quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">([</span><span class="n">m</span><span class="o">.</span><span class="n">valid</span><span class="p">()</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">m1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number physically valid() is True:&quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">([</span><span class="n">m</span><span class="o">.</span><span class="n">physically_valid</span><span class="p">()</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">m1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number value() is True: 2
Number physically valid() is True: 0
</pre></div></div>
</div>
<p>A Mueller matrix made from a random Jones matrix, however, always yields a valid Mueller matrix.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Returns a random complex number with a normal distribution...</span>
<span class="n">ranc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span>

<span class="c1"># Create 20 random Jones-Mueller matrices...</span>
<span class="n">m1</span> <span class="o">=</span> <span class="p">[</span><span class="n">JonesMueller</span><span class="p">([[</span><span class="n">ranc</span><span class="p">(),</span> <span class="n">ranc</span><span class="p">()],</span> <span class="p">[</span><span class="n">ranc</span><span class="p">(),</span> <span class="n">ranc</span><span class="p">()]])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>

<span class="c1"># See if they are valid...</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number value() is True:&quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">([</span><span class="n">m</span><span class="o">.</span><span class="n">valid</span><span class="p">()</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">m1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number physically valid() is True:&quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">([</span><span class="n">m</span><span class="o">.</span><span class="n">physically_valid</span><span class="p">()</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">m1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number value() is True: 20
Number physically valid() is True: 20
</pre></div></div>
</div>
<p>To make a random depolarizing Mueller matrix, we average some random Jones-Mueller matrices:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">RandomMuellerMatrix</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a random Mueller matrix by averaging `n` Jones-Mueller matrices.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ranc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="p">:</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">JonesMueller</span><span class="p">([[</span><span class="n">ranc</span><span class="p">(),</span><span class="n">ranc</span><span class="p">()],[</span><span class="n">ranc</span><span class="p">(),</span><span class="n">ranc</span><span class="p">()]])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span><span class="o">/</span><span class="n">n</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m is a valid Stokes to Stokes mapper:&quot;</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">valid</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m is the sum of Jones-Mueller matrices:&quot;</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">physically_valid</span><span class="p">())</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 0.7496536  -0.02316381  0.28254282  0.01511562]
 [ 0.02305587  0.06852028  0.29424932 -0.1383121 ]
 [ 0.43513517  0.11591739  0.35875425 -0.07703665]
 [-0.15790622  0.11519146 -0.01441158 -0.05414423]]
m is a valid Stokes to Stokes mapper: True
m is the sum of Jones-Mueller matrices: True
</pre></div></div>
</div>
</div>
<div class="section" id="Stokes-Vectors">
<h2>Stokes Vectors<a class="headerlink" href="#Stokes-Vectors" title="Permalink to this headline">¶</a></h2>
<p>The class <code class="docutils literal notranslate"><span class="pre">StokesVector</span></code> is used for handling Stokes vectors. We can create a Stokes vector a several ways. The <code class="docutils literal notranslate"><span class="pre">Polarization</span></code> function provides a means for generating arbitrary polarizations by name or parameter. (Note that SCATMECH’s convention for the signs of the Stokes vector elements differs from some others.)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unpolarized Stokes vector:&quot;</span><span class="p">,</span> <span class="n">StokesVector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unpolarized Stokes vector:&quot;</span><span class="p">,</span> <span class="n">StokesVector</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;s-polarized unit polarization from a Jones vector:&quot;</span><span class="p">,</span> <span class="n">JonesStokes</span><span class="p">((</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">))</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p-polarized unit Stokes vector:&quot;</span><span class="p">,</span> <span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;s-polarized unit Stokes vector:&quot;</span><span class="p">,</span> <span class="n">Polarization</span><span class="p">(</span><span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Left-handed circularly polarized unit Stokes vector:&quot;</span><span class="p">,</span> <span class="n">Polarization</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Right-handed circularly polarized unit Stokes vector with intensity 2:&quot;</span><span class="p">,</span> <span class="n">Polarization</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="n">I</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unpolarized Stokes vector:&quot;</span><span class="p">,</span> <span class="n">Polarization</span><span class="p">(</span><span class="s2">&quot;U&quot;</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unpolarized Stokes vector:&quot;</span><span class="p">,</span> <span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">DOP</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Linear polarization at 45 degrees:&quot;</span><span class="p">,</span> <span class="n">Polarization</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="mi">45</span><span class="o">*</span><span class="n">deg</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elliptically polarized radiation:&quot;</span><span class="p">,</span> <span class="n">Polarization</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="mi">34</span><span class="o">*</span><span class="n">deg</span><span class="p">,</span> <span class="n">ellipticity</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">deg</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Partially polarized radiation:&quot;</span><span class="p">,</span> <span class="n">Polarization</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="n">DOP</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Partially polarized elliptical polarized radiation with intensity 3:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">Polarization</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="mi">34</span><span class="o">*</span><span class="n">deg</span><span class="p">,</span> <span class="n">ellipticity</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">deg</span><span class="p">,</span> <span class="n">DOP</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Unpolarized Stokes vector: StokesVector(1,0,0,0)
Unpolarized Stokes vector: StokesVector(1,0,0,0)
s-polarized unit polarization from a Jones vector: StokesVector(1.0,1.0,0.0,0.0)
p-polarized unit Stokes vector: StokesVector(1,-1,0,0)
s-polarized unit Stokes vector: StokesVector(1,1,0,0)
Left-handed circularly polarized unit Stokes vector: StokesVector(1,0,0,1)
Right-handed circularly polarized unit Stokes vector with intensity 2: StokesVector(2,0,0,-2)
Unpolarized Stokes vector: StokesVector(1,0,0,0)
Unpolarized Stokes vector: StokesVector(1,0,0,0)
Linear polarization at 45 degrees: StokesVector(1.0,6.123233995736766e-17,1.0,0.0)
Elliptically polarized radiation: StokesVector(1.0,0.2869652992419897,0.7102640395405222,0.6427876096865393)
Partially polarized radiation: StokesVector(1.0,0.8,0.0,0.0)
Partially polarized elliptical polarized radiation with intensity 3:
 StokesVector(3.0,0.6026271284081782,1.4915544830350964,1.3498539803417322)
</pre></div></div>
</div>
<p>Note that polarization sensitivity can also be expressed as a Stokes vector. However, there is often a factor of two that enters for all but unpolarized sensitivity. That is, a perfect polarizer transmits 50 % of unpolarized radiation. We can apply <code class="docutils literal notranslate"><span class="pre">senstivity</span> <span class="pre">=</span> <span class="pre">True</span></code> to the <code class="docutils literal notranslate"><span class="pre">Polarization()</span></code> function, or use a <code class="docutils literal notranslate"><span class="pre">Sensitivity</span></code> function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Only sensitive to p-polarization</span>
<span class="c1"># The following two statements are equivalent...</span>
<span class="n">sens</span> <span class="o">=</span> <span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">sensitivity</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">sens</span> <span class="o">=</span> <span class="n">Sensitivity</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Signal for p-polarization:&#39;</span><span class="p">,</span><span class="n">sens</span> <span class="o">@</span> <span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Signal for s-polarization:&#39;</span><span class="p">,</span><span class="n">sens</span> <span class="o">@</span> <span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Signal for p-polarization: 1.0
Signal for s-polarization: 0.0
</pre></div></div>
</div>
<p>Sensitivity does not need to be full polarizing. By setting <code class="docutils literal notranslate"><span class="pre">DOP</span></code> in the range [0,1], sensitivity to the orthogonal polarization can be non-zero.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sens</span> <span class="o">=</span> <span class="n">Sensitivity</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span><span class="n">DOP</span><span class="o">=.</span><span class="mi">8</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;sens = &#39;</span><span class="p">,</span> <span class="n">sens</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Signal for p-polarization:&#39;</span><span class="p">,</span><span class="n">sens</span> <span class="o">@</span> <span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Signal for s-polarization:&#39;</span><span class="p">,</span><span class="n">sens</span> <span class="o">@</span> <span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
sens =  StokesVector(0.6,-0.4,0.0,0.0)
Signal for p-polarization: 1.0
Signal for s-polarization: 0.19999999999999996
</pre></div></div>
</div>
<p>In a manner similar to what we did with Mueller matrices, we can create a random Stokes vector by averaging a number of Stokes vectors created from Jones vectors. For a single Jones vector, the Stokes vector is depolarized. For more than one, the Stokes vector is partially polarized or unpolarized. We illustrate that by plotting the degree of polarization (using the <code class="docutils literal notranslate"><span class="pre">DOP()</span></code> method) as a function of the number of Jones-Stokes vectors we add.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">RandomStokesVector</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">ranc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="p">:</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">JonesStokes</span><span class="p">([</span><span class="n">ranc</span><span class="p">(),</span><span class="n">ranc</span><span class="p">()])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span><span class="o">/</span><span class="n">n</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">),[</span><span class="n">RandomStokesVector</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">DOP</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Degree of polarization vs. number of Jones-Stokes vectors&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;n&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;DOP&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/UsingMueller_20_0.svg" src="_images/UsingMueller_20_0.svg" /></div>
</div>
<p>We can multiply Mueller matrices and Stokes vectors. You can use the <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> or <code class="docutils literal notranslate"><span class="pre">*</span></code> operators or the <code class="docutils literal notranslate"><span class="pre">dot()</span></code> function to multiply the objects. If a Stokes vector multiplies a Mueller matrix from the left, it is assumed to be transposed first. The product of two Stokes vectors is the inner product, a scalar.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m1</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">m2</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">RandomStokesVector</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">RandomStokesVector</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m1 = </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">m1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m2 = </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">m2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;s1 = &quot;</span><span class="p">,</span><span class="n">s1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;s2 = &quot;</span><span class="p">,</span><span class="n">s2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m1 * s1 = &quot;</span><span class="p">,</span><span class="n">m1</span> <span class="o">*</span> <span class="n">s1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m1 @ s1 = &quot;</span><span class="p">,</span><span class="n">m1</span> <span class="o">*</span> <span class="n">s1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m1.dot(s1) = &quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">s1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m1 @ m2 = &quot;</span><span class="p">,</span><span class="n">m1</span> <span class="o">*</span> <span class="n">m2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;s1 @ m1 = &quot;</span><span class="p">,</span><span class="n">s1</span> <span class="o">*</span> <span class="n">m1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;s1 @ s2 = &quot;</span><span class="p">,</span><span class="n">s1</span> <span class="o">*</span> <span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
m1 =
 [[ 0.71919132 -0.10725727 -0.09137739 -0.33432796]
 [-0.05994711  0.06434309 -0.08475856 -0.06231133]
 [ 0.03679617  0.12047981 -0.22669581  0.16733113]
 [-0.11890352 -0.01121614 -0.23956275  0.2567618 ]]
m2 =
 [[ 0.70064638  0.39116556  0.25358188  0.08385315]
 [-0.13558652 -0.25830691 -0.02622567 -0.031701  ]
 [ 0.29043481  0.22505554  0.09312846  0.29159286]
 [ 0.05014109 -0.09274056  0.24353653 -0.09020427]]
s1 =  StokesVector(1.557341453858133,-0.5037104774316518,-0.18535976930719933,0.2855403558996586)
s2 =  StokesVector(1.0358216740391095,0.3634273927885747,0.20371247254655184,-0.07518310311299811)
m1 * s1 =  StokesVector(1.095526636078384,-0.12784997768235817,0.0864173309104673,-0.06180253633140159)
m1 @ s1 =  StokesVector(1.095526636078384,-0.12784997768235817,0.0864173309104673,-0.06180253633140159)
m1.dot(s1) =  [ 1.09552664 -0.12784998  0.08641733 -0.06180254]
m1 @ m2 =  [[ 0.47513869  0.31946894  0.09525588  0.06721944]
 [-0.07846697 -0.0533661  -0.03995746 -0.02616074]
 [-0.04800452 -0.0832649   0.02581059 -0.08193072]
 [-0.1384916  -0.12134091  0.01036314 -0.10263067]]
s1 @ m1 =  StokesVector(1.1094501651133053,-0.22498125054693396,-0.1259965656257641,-0.4469765314093099)
s1 @ s2 =  1.370837939315804
</pre></div></div>
</div>
</div>
<div class="section" id="Cloude-decomposition">
<h2>Cloude decomposition<a class="headerlink" href="#Cloude-decomposition" title="Permalink to this headline">¶</a></h2>
<p>So, now that we can create some physically valid Mueller matrices, we can explore some decompositions. The Cloude decomposition* decomposes a Mueller matrix into an incoherent, positive (convex) sum of Jones-Mueller matrices.</p>
<p>*S. R. Cloude, “Group theory and polarization algebra,” Optik (Stuttgart) <strong>75</strong>, 26–36 (1986) and S. R. Cloude and E. Pottier, “A review of target decomposition theorems in radar polarimetry,” IEEE Trans. Geosci. and Remote Sensing 34, 498–518 (1996).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">MCD</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">Cloude_Decomposition</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;M = </span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Cloude decomposition =</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">MCD</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =

 [[ 1.17013584 -0.244503   -0.40660445  0.19115841]
 [-0.02069653 -0.16931293  0.22059048 -0.01986653]
 [ 0.448397   -0.41249636 -0.11690515  0.15756951]
 [-0.43749541 -0.13336782  0.10634132  0.219973  ]]

Cloude decomposition =

[[ 0.68293319 -0.38043761 -0.45208352  0.10417859]
 [-0.08876268 -0.1723495   0.24190168 -0.16152496]
 [ 0.53670027 -0.45373576 -0.380827    0.20874414]
 [-0.25306021  0.12483815  0.32751513  0.21822242]]

[[ 0.33077735  0.19438969  0.07300214  0.07937304]
 [ 0.06706733 -0.0006191   0.03155379  0.25198991]
 [-0.01363084 -0.09434944  0.22419014 -0.03193241]
 [-0.21150158 -0.29813095 -0.11861436 -0.04217107]]

[[ 0.1447605  -0.06318984 -0.03553376  0.01325322]
 [ 0.00200977  0.0007505  -0.05179403 -0.11333669]
 [-0.07176921  0.13542409  0.04473803 -0.01827552]
 [ 0.01662508  0.0343083  -0.11001311  0.05020756]]

[[ 0.0116648   0.00473477  0.00801069 -0.00564644]
 [-0.00101096  0.00290516 -0.00107096  0.00300521]
 [-0.00290323  0.00016475 -0.00500632 -0.00096671]
 [ 0.0104413   0.00561668  0.00745367 -0.00628591]]

</pre></div></div>
</div>
<p>Notice that if we create the random Mueller matrix from less than four Jones-Mueller matrices, the Cloude decomposition will have only as many non-zero matrices as there were Jones-Mueller matrices. In the following, we plot the average magnitude of each element of the Cloude decomposition as a function of how many Jones-Mueller matrices were added.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">jmax</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">imax</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">mCD00sums</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">imax</span><span class="p">):</span>
    <span class="n">mCD00sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">jmax</span><span class="p">):</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">mCD</span> <span class="o">=</span> <span class="n">Cloude_Decomposition</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
        <span class="n">mCD00sum</span> <span class="o">=</span> <span class="n">mCD00sum</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">mCD</span><span class="p">])</span>
    <span class="n">mCD00sums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mCD00sum</span><span class="o">/</span><span class="n">jmax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mCD00sums</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Jones-Mueller matrices averaged&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cloude decomposition&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/UsingMueller_26_0.svg" src="_images/UsingMueller_26_0.svg" /></div>
</div>
</div>
<div class="section" id="Lu-Chipman-decomposition">
<h2>Lu-Chipman decomposition<a class="headerlink" href="#Lu-Chipman-decomposition" title="Permalink to this headline">¶</a></h2>
<p>The Lu-Chipman decomposition* decomposes a given Mueller matrix <span class="math notranslate nohighlight">\(\mathbf{M}\)</span> into the ordered product of three matrices:</p>
<div class="math notranslate nohighlight">
\[\mathbf{M} = \mathbf{M}_\Delta \mathbf{M}_R \mathbf{M}_D\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{M}_\Delta\)</span> is a depolarizer, <span class="math notranslate nohighlight">\(\mathbf{M}_R\)</span> is a retarder, and <span class="math notranslate nohighlight">\(\mathbf{M}_D\)</span> is a diattenuator. Notice that if there is only one Jones-Mueller matrix used to create the random matrix, there will be no depolarization.</p>
<p>*S.-Y. Lu and R. A. Chipman, “Interpretation of Mueller matrices based on polar decomposition,” J. Opt. Soc. Am. A 13, 1106–1113 (1996)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">printMatrix</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">M</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="s2">&quot;=</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">depol</span><span class="p">,</span> <span class="n">ret</span><span class="p">,</span> <span class="n">diatten</span> <span class="o">=</span> <span class="n">Lu_Chipman_Decomposition</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span><span class="n">M</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;Depolarizer&quot;</span><span class="p">,</span><span class="n">depol</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;Retarder&quot;</span><span class="p">,</span><span class="n">ret</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;Diattenuator&quot;</span><span class="p">,</span><span class="n">diatten</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;The product Depolarizer . Retarder .  Diattenuator&quot;</span><span class="p">,</span><span class="n">depol</span> <span class="o">@</span> <span class="n">ret</span> <span class="o">@</span> <span class="n">diatten</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

 M =

[[ 0.94606062 -0.08551657 -0.11638826  0.37965837]
 [-0.50249414  0.10084533  0.11367953 -0.18341356]
 [ 0.1104401  -0.06834663 -0.03834099  0.05798649]
 [-0.15088816  0.07008065 -0.17876931  0.19146469]]

 Depolarizer =

[[ 1.          0.          0.          0.        ]
 [-0.52586884  0.08217886 -0.03965302 -0.00704899]
 [ 0.09884617 -0.03965302  0.06415846  0.01981454]
 [-0.31540324 -0.00704899  0.01981454  0.41057267]]

 Retarder =

[[ 1.00000000e+00  0.00000000e+00 -1.21430643e-17  0.00000000e+00]
 [-1.77635684e-15  3.70572744e-01  7.88043276e-01  4.91592958e-01]
 [ 0.00000000e+00 -9.08516285e-01  1.97527652e-01  3.68213236e-01]
 [ 2.22044605e-16  1.93064762e-01 -5.83069997e-01  7.89148513e-01]]

 Diattenuator =

[[ 0.94606062 -0.08551657 -0.11638826  0.37965837]
 [-0.08551657  0.85848021  0.00552804 -0.01803247]
 [-0.11638826  0.00552804  0.86194214 -0.02454223]
 [ 0.37965837 -0.01803247 -0.02454223  0.9344752 ]]

 The product Depolarizer . Retarder .  Diattenuator =

[[ 0.94606062 -0.08551657 -0.11638826  0.37965837]
 [-0.50249414  0.10084533  0.11367953 -0.18341356]
 [ 0.1104401  -0.06834663 -0.03834099  0.05798649]
 [-0.15088816  0.07008065 -0.17876931  0.19146469]]
</pre></div></div>
</div>
</div>
<div class="section" id="Reverse-Lu-Chipman-decomposition">
<h2>Reverse Lu-Chipman decomposition<a class="headerlink" href="#Reverse-Lu-Chipman-decomposition" title="Permalink to this headline">¶</a></h2>
<p>The reverse Lu-Chipman decomposition is similar to the Lu-Chipman decomposition, except that the order of the elements us reversed. That is,</p>
<div class="math notranslate nohighlight">
\[\mathbf{M} = \mathbf{M}^\prime_D \mathbf{M}^\prime_R  \mathbf{M}^\prime_\Delta\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{M}^\prime_D\)</span> is a diattenuator, <span class="math notranslate nohighlight">\(\mathbf{M}^\prime_R\)</span> is a retarder, and <span class="math notranslate nohighlight">\(\mathbf{M}^\prime_\Delta\)</span> is a depolarizer.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">diatten</span><span class="p">,</span> <span class="n">ret</span><span class="p">,</span> <span class="n">depol</span> <span class="o">=</span> <span class="n">Reverse_Lu_Chipman_Decomposition</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span><span class="n">M</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;Diattenuator&quot;</span><span class="p">,</span><span class="n">diatten</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;Retarder&quot;</span><span class="p">,</span><span class="n">ret</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;Depolarizer&quot;</span><span class="p">,</span><span class="n">depol</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;The product Diattenuator . Retarder .  Depolarizer&quot;</span><span class="p">,</span> <span class="n">diatten</span> <span class="o">@</span> <span class="n">ret</span> <span class="o">@</span> <span class="n">depol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

 M =

[[ 1.80605578e+00  9.32760770e-01  1.25840594e-01  2.64980983e-01]
 [ 1.05160612e-01 -1.17225430e-01 -2.46284148e-01  5.27805422e-01]
 [ 1.24682255e-03 -1.26125951e-01 -1.28924973e-01  7.28457466e-01]
 [-2.93026911e-01 -9.90280778e-02  2.78125415e-01 -9.81781411e-01]]

 Diattenuator =

[[ 1.80605578e+00  1.05160612e-01  1.24682255e-03 -2.93026911e-01]
 [ 1.05160612e-01  1.78210473e+00  3.65729004e-05 -8.59532423e-03]
 [ 1.24682255e-03  3.65729004e-05  1.77902050e+00 -1.01909297e-04]
 [-2.93026911e-01 -8.59532423e-03 -1.01909297e-04  1.80297069e+00]]

 Retarder =

[[ 1.00000000e+00 -3.55271368e-15  8.88178420e-16  0.00000000e+00]
 [ 0.00000000e+00 -7.10309156e-01 -6.89686217e-01  1.40690529e-01]
 [ 4.23516474e-20 -4.30298886e-01  5.83640098e-01  6.88626971e-01]
 [ 0.00000000e+00 -5.57049164e-01  4.28599065e-01 -7.11336116e-01]]

 Depolarizer =

[[ 1.          0.52705561  0.1057955   0.04248758]
 [ 0.          0.0825127   0.03809741 -0.08421396]
 [ 0.          0.03809741  0.12990791 -0.19162369]
 [ 0.         -0.08421396 -0.19162369  0.70430978]]

 The product Diattenuator . Retarder .  Depolarizer =

[[ 1.80605578e+00  9.32760770e-01  1.25840594e-01  2.64980983e-01]
 [ 1.05160612e-01 -1.17225430e-01 -2.46284148e-01  5.27805422e-01]
 [ 1.24682255e-03 -1.26125951e-01 -1.28924973e-01  7.28457466e-01]
 [-2.93026911e-01 -9.90280778e-02  2.78125415e-01 -9.81781411e-01]]
</pre></div></div>
</div>
</div>
<div class="section" id="Symmetric-Decomposition">
<h2>Symmetric Decomposition<a class="headerlink" href="#Symmetric-Decomposition" title="Permalink to this headline">¶</a></h2>
<p>The symmetric decomposition, introduced by Ossikovski,* is a decomposition that treats the ordering of the Mueller matrix product as symmetric. That is, the Mueller matrix <span class="math notranslate nohighlight">\(\mathbf{M}\)</span> is decomposed into</p>
<div class="math notranslate nohighlight">
\[\mathbf{M} = \mathbf{M}_{D_2} \mathbf{M}_{R_2}  \mathbf{M}_\Delta \mathbf{M}_{R_1} \mathbf{M}_{D_1}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{M}_{D_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{M}_{D_2}\)</span> are a diattenuators, <span class="math notranslate nohighlight">\(\mathbf{M}^\prime_{R_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{M}^\prime_{R_2}\)</span> are retarders, and <span class="math notranslate nohighlight">\(\mathbf{M}_\Delta\)</span> is a diagonal depolarizer.</p>
<p>*R. Ossikovski, “Analysis of depolarizing Mueller matrices through a symmetric decomposition,” J. Opt. Soc. Am. A, 26(5), 1109-1118 (2009).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">diatten2</span><span class="p">,</span> <span class="n">ret2</span><span class="p">,</span> <span class="n">depol</span><span class="p">,</span> <span class="n">ret1</span><span class="p">,</span> <span class="n">diatten1</span> <span class="o">=</span> <span class="n">Symmetric_Decomposition</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span><span class="n">M</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;diatten2&quot;</span><span class="p">,</span><span class="n">diatten2</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;ret2&quot;</span><span class="p">,</span><span class="n">ret2</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;depol&quot;</span><span class="p">,</span><span class="n">depol</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;ret1&quot;</span><span class="p">,</span><span class="n">ret1</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;diatten1&quot;</span><span class="p">,</span><span class="n">diatten1</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;The product Diattenuator2 . Retarder2 .  Depolarizer . Retarder1 . Diattenuator1&quot;</span><span class="p">,</span>
            <span class="n">diatten2</span> <span class="o">@</span> <span class="n">ret2</span> <span class="o">@</span> <span class="n">depol</span> <span class="o">@</span> <span class="n">ret1</span> <span class="o">@</span> <span class="n">diatten1</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

 M =

[[ 1.46384903  0.3961865  -0.19328042  0.63050977]
 [ 0.68097141  0.15323854 -0.34204183  0.49943981]
 [-0.12736628  0.15402006  0.40274878  0.09028221]
 [ 0.02172101 -0.29007436  0.97942981  0.2363554 ]]

 diatten2 =

[[ 1.          0.39125711 -0.17165705  0.08158025]
 [ 0.39125711  0.98099312 -0.03534022  0.01679549]
 [-0.17165705 -0.03534022  0.91594722 -0.00736872]
 [ 0.08158025  0.01679549 -0.00736872  0.90394432]]

 ret2 =

[[ 1.          0.          0.          0.        ]
 [ 0.          0.19721567 -0.94646177  0.25557015]
 [ 0.         -0.31763609 -0.30831608 -0.89668752]
 [ 0.         -0.92747684 -0.09566253  0.36143518]]

 depol =

[[1.44768626 0.         0.         0.        ]
 [0.         1.44768626 0.         0.        ]
 [0.         0.         0.39914535 0.        ]
 [0.         0.         0.         0.39914535]]

 ret1 =

[[ 1.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  1.88416535e-01 -9.66610058e-01 -1.73678451e-01]
 [ 0.00000000e+00  3.56740786e-05  1.76852638e-01 -9.84237341e-01]
 [ 0.00000000e+00 -9.82089206e-01 -1.85440394e-01 -3.33564442e-02]]

 diatten1 =

[[ 1.          0.3291368  -0.05982523  0.36745938]
 [ 0.3291368   0.92579183 -0.01054222  0.0647526 ]
 [-0.05982523 -0.01054222  0.86970852 -0.01176969]
 [ 0.36745938  0.0647526  -0.01176969  0.9400843 ]]

 The product Diattenuator2 . Retarder2 .  Depolarizer . Retarder1 . Diattenuator1 =

[[ 1.46384903  0.3961865  -0.19328042  0.63050977]
 [ 0.68097141  0.15323854 -0.34204183  0.49943981]
 [-0.12736628  0.15402006  0.40274878  0.09028221]
 [ 0.02172101 -0.29007436  0.97942981  0.2363554 ]]
</pre></div></div>
</div>
</div>
<div class="section" id="Differential-(Logarithmic)-Decomposition">
<h2>Differential (Logarithmic) Decomposition<a class="headerlink" href="#Differential-(Logarithmic)-Decomposition" title="Permalink to this headline">¶</a></h2>
<p><p>The differential decomposition is simply the matrix logarithm of the Mueller matrix.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">MuellerLog</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span><span class="n">M</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">,</span><span class="n">L</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;MuellerExp(L)&quot;</span><span class="p">,</span><span class="n">MuellerExp</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

 M =

[[ 1.19313013e+00 -3.17709986e-01 -2.53469775e-01  4.05155642e-02]
 [ 5.01161264e-01 -2.77044957e-01  6.98787061e-02 -3.06338215e-01]
 [ 2.06867982e-02  4.55792780e-01 -4.58421352e-01 -1.18858157e-03]
 [ 3.82564813e-03 -1.75772107e-01 -1.94782408e-02  1.30472629e-01]]

 L =

[[ 0.33909928+0.20136727j -0.66361655-0.46261655j -0.3053396 -0.4673677j
  -0.00304323-0.6870683j ]
 [ 0.64127007+0.77054697j -1.43810593-2.29582086j -0.41682829+0.13324753j
  -0.23815213-1.95377116j]
 [ 0.5303973 +0.06407489j -1.1047445 +0.62962625j -0.96488405-2.98900069j
  -0.79473686-1.21681015j]
 [-0.01800446+0.41735065j -0.18904692-1.13335288j -0.12292056-0.33049353j
  -1.39399131-1.19973103j]]

 MuellerExp(L) =

[[ 1.19313013e+00 -3.17709986e-01 -2.53469775e-01  4.05155642e-02]
 [ 5.01161264e-01 -2.77044957e-01  6.98787061e-02 -3.06338215e-01]
 [ 2.06867982e-02  4.55792780e-01 -4.58421352e-01 -1.18858157e-03]
 [ 3.82564813e-03 -1.75772107e-01 -1.94782408e-02  1.30472629e-01]]
</pre></div></div>
</div>
</div>
<div class="section" id="Other-parameters">
<h2>Other parameters<a class="headerlink" href="#Other-parameters" title="Permalink to this headline">¶</a></h2>
<p>One can obtain other parameters associated with a Mueller matrix.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tmax = &quot;</span><span class="p">,</span><span class="n">M</span><span class="o">.</span><span class="n">Tmax</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tmin = &quot;</span><span class="p">,</span><span class="n">M</span><span class="o">.</span><span class="n">Tmin</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;diattenuation = &quot;</span><span class="p">,</span><span class="n">M</span><span class="o">.</span><span class="n">diattenuation</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;linear diattenuation = &quot;</span><span class="p">,</span><span class="n">M</span><span class="o">.</span><span class="n">linear_diattenuation</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;polarization dependent loss = &quot;</span><span class="p">,</span><span class="n">M</span><span class="o">.</span><span class="n">polarization_dependent_loss</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;polarizance = &quot;</span><span class="p">,</span><span class="n">M</span><span class="o">.</span><span class="n">polarizance</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;depolarization index = &quot;</span><span class="p">,</span><span class="n">M</span><span class="o">.</span><span class="n">depolarization_index</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;extinction_ratio = &quot;</span><span class="p">,</span><span class="n">M</span><span class="o">.</span><span class="n">extinction_ratio</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Tmax =  1.2589785356860683
Tmin =  0.5199365765637283
diattenuation =  0.4154453205963677
linear diattenuation =  0.3939128728601519
polarization dependent loss =  3.840679555770598
polarizance =  0.45526617740978426
depolarization index =  0.7276833452824957
extinction_ratio =  2.421407903261363
</pre></div></div>
</div>
<p>There is also a class <code class="docutils literal notranslate"><span class="pre">CharacterizedMueller</span></code> that performs a Lu-Chipman decomposition and extracts parameters from them. This is treated as a separate class, because initialization performs the decomposition, assigning values to the parameters. Note that the parameters differ from those shown above, due to differences in definition.</p>
<ol class="upperalpha simple" start="14">
<li><p>Ghosh, M.F.G. Wood, and I.A. Vitkin, ‘’Mueller matrix decomposition for extraction of individual polarization parameters from complex turbid media exhibiting multiple scattering, optical activity, and linear birefringence,’’ J. Biomedical Opt. 13, 044036 (2008).</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">parametersM</span> <span class="o">=</span> <span class="n">CharacterizedMueller</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">parametersM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mdepol =
[[ 1.          0.          0.          0.        ]
 [-0.15241731  0.7082728   0.06726665  0.04118267]
 [ 0.06385021  0.06726665  0.68005538 -0.04259958]
 [ 0.11890581  0.04118267 -0.04259958  0.52114058]]
Mret =
[[ 1.00000000e+00  2.77555756e-17  6.93889390e-18  0.00000000e+00]
 [ 2.77555756e-17 -2.82759077e-01  9.53473456e-01  1.04573768e-01]
 [ 0.00000000e+00 -8.49900807e-01 -2.99587897e-01  4.33492457e-01]
 [ 0.00000000e+00  4.44652587e-01  3.36965971e-02  8.95069057e-01]]
Mdiatten =
[[ 0.88945756  0.12922865 -0.32566584  0.11742006]
 [ 0.12922865  0.81889883 -0.0247776   0.00893366]
 [-0.32566584 -0.0247776   0.87150814 -0.02251349]
 [ 0.11742006  0.00893366 -0.02251349  0.81718406]]
DiattenuationVector = [ 0.12922865 -0.32566584  0.11742006]
Diattenuation = 0.3695209795611701
CircularDiattenuation = 0.11742006422255213
LinearDiattenuation = 0.3503687812203285
DiattenuationAngle = -0.596519915269382 rad (-34.178073540437055 deg)
PolarizanceVector = [-0.15241731  0.06385021  0.11890581]
Polarizance = 0.2035840799570722
DepolarizationCoefficient = 0.6364895856784171
LinearRetardance = 0.462210287031518 rad (26.482698694436348 deg)
OpticalRotation = 0.6292230921471116 rad (36.051827552200784 deg)
Retardance = 1.9215854252877458 rad (110.0987348428392deg)
RetardanceAngle = 0.03781864114978353 rad (2.166848524802379 deg)
</pre></div></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="UsingFresnel.html" class="btn btn-neutral float-right" title="Using the Fresnel module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="pySCATMECH : A Python Interface to the SCATMECH Library" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>